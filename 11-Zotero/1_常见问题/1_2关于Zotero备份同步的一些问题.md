---
uid: 20230724005715
title: 1x02 关于 Zotero 备份同步的一些问题
tags: [zotero, 教程]
description: 关于Zotero备份同步的一些问题
author: darkluna999
type: other
draft: false
editable: false
modified: 20231001224641
---

# 1x02 关于 Zotero 备份同步的一些问题

> 出现 **iPhone/iPad 上的 Zotero 官方客户端或 Papership 应用中无法打开 PDF 附件** 的问题，基本 **全都是选择了不合适的同步方案** 。
> 请务必注意：
如果你希望在上述两个应用中正常打开 PDF 附件， **‼️电脑上绝对！绝对！绝对不能使用 ZotFile + 同步盘的方案进行同步‼️** 。只要你使用了 ZotFile + 同步盘的方案，你的 PDF 附件就一定无法在 iPhone/iPad 上的 Zotero 官方客户端或 Papership 应用中打开。

- 如果你使用了 ZotFile 插件，很可能会遇到下面这个报错：
![[Pasted image 20231001224302.png]]
iOS/iPadOS 上不支持链接的文件附件。您可以使用 Zotero 桌面应用程序打开此类附件。

请务必牢记： **使用 Zotfile + 同步盘 方案会导致 iPhone/iPad 上的 Zotero 客户端里无法打开 PDF 附件这件事是板上钉钉的！** 丝毫没有讨价还价的余地！

## 本文档分为以下几个步骤帮助大家确定目前在用的同步方案，解决一些历史遗留问题，并为常见的问题作出解答

> [[#一、如何判断我目前是否正确使用 WebDAV 同步附件]]
> [[#二、如何切换到 WebDAV 同步方案]]
> [[#三、正确配置 Zotero 的移动版客户端中的同步设置]]
> [[#四、关于坚果云免费版的流量限制]]
> [[#五、常见的同步失败原因：网络问题]]
> [[#六、设置后连接成功，同步过程中出现问题的排查]]

### 一、如何判断我目前是否正确使用 WebDAV 同步附件

**最简单的判断所用同步方案的方法：确认下附件是本地存储的附件，还是链接的附件**

在你电脑上的 Zotero 打开文献条目列表，随便找一个条目，展开这一条目。

- 如果 **PDF 附件图标上没有“链条”标记** ，说明你用的是 **官方云同步/WebDAV 同步/没有同步** 。样式如下图：
![[Pasted image 20231001224320.png]]

这样的附件还保存在你的 Zotero 数据目录内的默认位置， **在正确配置 WebDAV 同步之后** 可以在官方的 Zotero 应用或第三方的 Papership 应用中打开。（当然，直接下血本购入官方的同步方案就更可以了）

- 如果 **PDF 附件图标上存在“链条”标记** ，说明你用的是 **Zotfile + 同步盘** 方案。样式如下图：
![[Pasted image 20231001224437.png]]
这样的附件已经被移动到了其他的地方，Zotero 里仅仅保存的是一个文件链接（相当于是一个快捷方式）。这样的文件 **无论你怎么设置也是不可能** 在官方的 Zotero 应用或第三方的 Papership 应用中正常打开的。

无论你 Zotfile 中设置的目标目录在哪，甚至哪怕你把 Zotfile 目标目录设置成了 Zotero 默认的数据存储位置， **只要你的 PDF 附件图标上有“链条”标记，它就属于类似于 Zotfile + 同步盘的方案。** 这意味着它就一定是无法在移动端 Zotero 客户端里打开的，就算 WebDAV 都配置对了也不行。

### 二、如何切换到 WebDAV 同步方案

首先需要开启 WebDAV 同步

见 [[0_5Zotero备份与同步#WebDAV]]

正确设置了 WebDAV 同步后，如果你的 PDF 附件图标上带有“链条”标记，还需要使用下面这个教程的方法，将你的链接的附件转换为本地存储的附件：

1. 首先恢复文件链接地址：编辑 - 首选项 - 高级 - 文件和文件夹 - 改为使用绝对路径 - 检查数据库完整性
![[source/Pasted image 20230724012427.png]]
2. 配置 Zotfile：工具 - 附加组件 -ZotFile preference
![[source/Pasted image 20230724012140.png]]
3. General Settings - Attach stored copy - OK
![[source/Pasted image 20230724012701.png]]
4. 在我的文库中，`ctrl+A` 全选后，右键
![[source/Pasted image 20230724012855.png]]
5. 等待库内全部完成更新
6. 手动触发同步并等待同步完成 [[11-Zotero/0_基础使用/0_2Zotero基础配置#手动触发同步]]

### 三、正确配置 Zotero 的移动版客户端中的同步设置

如果上面的问题你全都解决好了， **PDF 附件图标上没链条了** ，坚果云里也能看见一堆 .prop 和 .zip 格式的文件，iPhone/iPad 上却还是打不开文件，大概率就是 **你在 iPhone/iPad 上的同步设置没设置好** 。

‼️请务必注意， **iPhone/iPad 上的 Zotero 客户端里也要像电脑上一样设置 WebDAV 同步** ，否则一定是打不开的。步骤如下：

1. 回到文献列表（My Library）。
2. 点击左上角的 [Back] 按钮。
3. 点击右上角的 [齿轮/⚙️]（设置）按钮。
4. 点击 [Account]。
![[Pasted image 20231001224508.png]]
5. 在 [FILE SYNCING] 中选择 [WebDAV]。
6. 在下方填写服务器地址、用户名。‼️请务必确保这里的服务器地址及邮箱都和电脑上的一模一样，尤其是 **要注意 [服务器地址] 结尾的地方千万不要多输入一个“/”符号** （因为他后面的“/zotero/”里已经自带这个符号了）
![[Pasted image 20231001224519.png]]
7. 前往坚果云官网为这个设备申请一个新的应用密码并填进去（ **强烈建议为每一个设备都新建一个不同的设备密码，否则可能会出现一些玄学问题！** ）。登陆坚果云官网后，点击网页右上角处你的昵称，然后点击 [账户信息] -> [安全选项]，在右边或下边的 [第三方应用管理] 中点击 [添加应用] 按钮，随便起一个名字，然后点击 [生成密码] 即可获得一个新的应用密码。
[**--> 点击这里查看坚果云如何生成应用密码 <--**](https://help.jianguoyun.com/?p=2064)

![[Pasted image 20231001224532.png]]

- 注 1：Zotero 同步中用到的密码 **不是登陆坚果云官网用的密码** ，而是在这里单独生成的应用密码。
- 注 2： **在任何情况下都不要重复使用同一个应用密码！** 你应该为每一个设备、每一个软件内都分别生成一个新的密码（无论他们是不是在一个电脑上，无论他们系统是什么，甚至无论他们是不是都是 Zotero，都必须每一个需要填密码的地方都使用不同的应用密码）。

### 四、关于坚果云免费版的流量限制

- 坚果云同步 **免费版** 每个月 **上传 1G 下载 3G** ，重置周期 **不按照自然月** ，而是与你的注册时间有关。想要查看这一日期，可以登陆网页版坚果云，点击右上角的昵称 -> [账户信息]，流量重置日期会在 [个人信息] 里的 [有效期] 中显示。遇到无法下载或同步失败的问题，请先排查流量是否足够。
- [坚果云官方Q&A](https://help.jianguoyun.com/?category_name=faq)

### 五、常见的同步失败原因：网络问题

虽然我认为没必要写，但看起来还是有的...

![[Pasted image 20231001224546.png]]

这种情况下，检查你得网络连接比如 WIFI/蜂窝数据/网桥等是否能正常访问网络或需要登陆

### 六、设置后连接成功，同步过程中出现问题的排查

这一问题可能有以下几种现象：

- 以上所有设置都配置好了，验证也能通过，但有一些附件打不开
- 同步的时候总感觉有些附件没同步上
- 我从坚果云切换到了其他支持 WebDAV 的网盘，但我怎么点同步他都同步不过去，而且还不报错
- 验证是成功的，但同步就是老报错

**前期准备 - 重置同步状态 - 重新同步**

要解决上述问题，首先你需要在 [Zotero 首选项] 中重置同步状态：

一般来说，没有报错的人重置同步状态以后同步就正常了。下面就是要处理一些报错的可能情况：

Zotero 官方的同步属于第三方软件同步，受到限制如下

- 文件上传大小限制：当前 WebDAV 客户端和网页端上传大小的限制是一致的，默认为 500M（私有云可以通过相关设置调整）。**(通常引起 413)**
- 访问频率限制：免费版用户限制访问频率为每 30 分钟不超过 600 次请求。付费用户限制访问频率为每 30 分钟不超过 1500 次请求。**(通常引起 403)**
- 同步目录数限制：目前坚果云的 WebDAV 协议单次请求文件数（包含文件和文件夹）为 750 个，支持分多页多次加载。**(通常引起 403)**

如果使用其余 WebDAV 服务，均以具体运营商规定/私有云设置为准，排查大体思路不变。

### 常见报错速查

Zotero WebDAV 常见的 HTTP 错误代码有以下几点

#### 401

![[Pasted image 20231001224600.png]]

401 报错是指验证错误，一般见于账号密码错误

**注意：密码应该为官网生成的应用密码，每个设备单独申请使用，请勿混用或使用坚果云登陆密码**

![[Pasted image 20231001224611.png]]

#### 403

![[Pasted image 20231001224618.png]]

![[Pasted image 20231001224629.png]]

403forbidden 比较复杂建议参考

[403错误常见分析](https://www.cnblogs.com/jiaoaozuoziji/p/7283322.html)

**太长不看：** 403 要么是访问次数过多被封 ip 了要么是其他原因被封了账号，建议联系坚果云官方客服进一步确认排查、

因为坚果云对第三方软件有如下限制，一次（一般为首次）进行大量同步时很容易碰线被 ban，稍等一段时间就好了

- 访问频率限制：免费版用户限制访问频率为每 30 分钟不超过 600 次请求。付费用户限制访问频率为每 30 分钟不超过 1500 次请求。**(通常引起 403)**
- 同步目录数限制：目前坚果云的 WebDAV 协议单次请求文件数（包含文件和文件夹）为 750 个，支持分多页多次加载。**(通常引起 403)**

#### 404

404 一般是因为访问文件/路径不存在导致的

注意：输入的地址应该分别为 `https` 以及 `dav.jianguoyun.com/dav`

以坚果云为例图示如下：

![[Pasted image 20231001224640.png]]

[坚果云如何生成应用密码](https://help.jianguoyun.com/?p=2064)

其余 WebDAV 服务报错请咨询对应的服务商或管理员

链接成功后无法同步或下载附件的进一步排查：

1. PC 端 WebDAV 设置是否有误，验证服务器后点击数据库主页右上角绿色的小箭头进行同步并等待同步完成
2. 检查坚果云云端是否生成了 Zotero/storage 及下属文件夹和其内对应附件是否存在 --> 如果不存在则有可能是没能完成同步，尝试切换网络环境进行同步

#### 413

413 错误见于 php（或其他）上传中转溢出，说人话就是文件体积过大

（也可见于一些反向代理的 Nginx 服务配置分片等有问题）

注意：虽然现在坚果云支持单文件最大 5GB 但是只限于坚果云客户端。Zotero 上传被视为第三方客户端，坚果云对其限制目前是 500M

解决方案：

1. 对过大的 PDF 文件单体使用如 Acrobat DC 之类的编辑器进行拆分/重新编码压缩为体积较小的文件后重新上传
2. 或直接手动发送该过大附件，不要使用同步方式